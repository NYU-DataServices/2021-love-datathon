<--
.. title: Support Schedule
.. slug: support-schedule
.. date: 2020-12-10
-->


<html>
<body>

<p>General events for Love Data Week can be found here: . The below represents our datathon-specific support!</p>

  <div class="table-responsive mt-2">
  <table class="table table-bordered">
  <thead>
  <tr>
    <th scope="col" class="col-2" id="time-header">Time (EST)</th>
    <th scope="col" class="col-5">Data Science Club Support</th>
    <th scope="col" class="col-5">Data Services Support</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <th scope="row" class="time table-primary" colspan="3">February 6th</th>
  </tr>
  <tr>
    <th scope="row" class="time">11:00 am</th>
    <td>Adi</td>
    <td>Vicky</td>
  </tr>
  <tr>
    <th scope="row" class="time">4:00 pm</th>
    <td></td>
    <td>Katie</td>
  </tr>
  <tr>
    <th scope="row" class="time table-primary" colspan="3">February 7th</th>
  </tr>
  <tr>
    <th scope="row" class="time">11:00 am</th>
    <td>Adi</td>
    <td>Vicky</td>
  </tr>
  <tr>
    <th scope="row" class="time">4:00 pm</th>
    <td></td>
    <td>Katie</td>
  </tr>
  </tbody>
</table>
</div>

<script>
// JavaScript is enabled! Show the timezone chooser
var chooser = document.getElementById("timezone-chooser");
chooser.style.display = "";

// Change time header
document.getElementById("time-header").innerText = "Time";


// Try and get local timezone name
var tz_name;
try {
  tz_name = Intl.DateTimeFormat().resolvedOptions().timeZone;
  console.log("Local timezone:", tz_name);
} catch(ex) {
  tz_name = "(local timezone)";
  console.log("Can't get local timezone name");
}

// Get local timezone offset
// XXX: Note that this only works if the offset is currently the same as on that day (no daylight saving or whatever)
var tz_offset = -new Date().getTimezoneOffset();

// Try and find the local timezone in the list
var timezone_set = false;
for(var i = 0; i < chooser.options.length; ++i) {
  if(tz_name == chooser.options[i].value) {
    // If the user's settings disagree with our list, use the user's setting
    if(parseInt(chooser.options[i].getAttribute("data-offset")) != tz_offset) {
      chooser.options[i].setAttribute("data-offset", tz_offset);
      console.log("Changing offset from ", chooser.options[i].getAttribute("data-offset"), " to ", tz_offset);
    }

    // Select this timezone
    chooser.value = tz_name;
    timezone_set = true;
    break;
  }
}

// If we didn't find the timezone, add an option
if(!timezone_set) {
  console.log("Adding unknown local timezone to list");

  var opt = document.createElement("option");
  opt.value = tz_name;
  opt.innerText = tz_name;
  opt.setAttribute("data-offset", tz_offset);
  chooser.appendChild(opt);

  // And select it
  chooser.value = tz_name;
}


// Store the original UTC minute of the day on elements
var times = document.getElementsByClassName("time");
for(var i = 0; i < times.length; ++i) {
  // Parse the time
  var matches = times[i].innerText.match(/([0-9]+):([0-9]+) (am|pm)/);
  if(!matches) {
    console.log("Parse error: ", times[i].innerText);
    continue;
  }
  var minutes = parseInt(matches[1]) * 60 + parseInt(matches[2]);
  if(matches[3] == "pm") {
    minutes += 12 * 60;
  }
  if((minutes % (12 * 60)) < 60) {
    minutes += 12 * 60;
  }

  // Convert from EST
  minutes += 300;

  // Normalize
  while(minutes < 0) {
    minutes += 24 * 60;
  }
  while(minutes >= 24 * 60) {
    minutes -= 24 * 60;
  }
  times[i].setAttribute("data-minutes-utc", minutes);
}


function zeroPad2(num) {
  num = "" + num;
  if(num.length < 2) {
    num = "0" + num;
  }
  return num;
}

// Now update the times when the timezone is changed
function updateTimes() {
  if(chooser.selectedOptions.length == 0) {
    return;
  }
  offset = parseInt(chooser.selectedOptions[0].getAttribute("data-offset"));

  var times = document.getElementsByClassName("time");
  for(var i = 0; i < times.length; ++i) {
    var minutes = parseInt(times[i].getAttribute("data-minutes-utc"));
    minutes += offset;
    if(minutes < 0) {
      minutes += 24 * 60;
    } else if(minutes >= 24 * 60) {
      minutes -= 24 * 60;
    }
    var ampm;
    if(minutes >= 13 * 60) {
      minutes -= 12 * 60;
      ampm = "pm";
    } else if(minutes >= 12 * 60) {
      ampm = "pm";
    } else if(minutes >= 60) {
      ampm = "am";
    } else {
      minutes += 12 * 60;
      ampm = "am";
    }
    times[i].innerText = zeroPad2(Math.floor(minutes / 60)) + ":" + zeroPad2(minutes % 60) + " " + ampm;
  }
}
chooser.addEventListener("change", updateTimes);
updateTimes();
</script>

</body>
</html>
